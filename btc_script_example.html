<!DOCTYPE html>
<html>
<head>
    <meta charset="UTF-8">
    <script src="https://bitcoincore.tech/apps/bitcoinjs-ui/lib/bitcoinjs-lib.js"></script>
    <script src="https://bundle.run/buffer@6.0.3"></script>
    <script src="https://bundle.run/varuint-bitcoin@1.1.2"></script>
</head>
<body>
    <script>
        // script creates pub/private keys and sets winners hash
        var alice = bitcoinjs.ECPair.makeRandom()
        var alice_priv = alice.privateKey.toString("hex")
        var alice_pub = alice.publicKey.toString("hex")
        console.log("alice", alice_pub)
        var bob = bitcoinjs.ECPair.makeRandom()
        var bob_priv = bob.privateKey.toString("hex")
        var bob_pub = bob.publicKey.toString("hex")
        console.log("bob", bob_pub)
        // hash for potential winners in game
        var packers_hash = "8cb74f633826472ec0709268506e5b9af9729ef1"
        var saints_hash = "6fb18f274fec83bb2511460ab3dd90099c8a6b95"
    </script>

    <script>
        // script sets function for the game
        function ballgameScript(alice_pub, bob_pub, packers_hash, saints_hash) {
            return bitcoinjs.script.fromASM(`
                OP_IF OP_HASH160 ${packers_hash} OP_EQUALVERIFY
                ${alice_pub} OP_CHECKSIG
                OP_ELSE OP_HASH160 ${saints_hash} OP_EQUALVERIFY
                ${bob_pub} OP_CHECKSIG
                OP_ENDIF`.trim().replace(/\s+/g, ' '));
        }
    </script>
    
    <script>
        // script to call function
        function ballgame(alice_pub, bob_pub, packers_hash, saints_hash) {
            var p2wsh = bitcoinjs.payments.p2wsh({redeem: {output:
            ballgameScript( alice_pub, bob_pub, packers_hash, saints_hash
            ), network: bitcoinjs.networks.regtest}, network: 
            bitcoinjs.regtest });
            console.log('P2WSH smart contract address: ', p2wsh.address);
            return p2wsh.address;
        }
        ballgame( alice_pub, bob_pub, packers_hash, saints_hash );
    </script>
 
</body>
</html>
